<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Co-Create/validate">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Validate | IBM Client Engineering</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ibm-client-engineering.github.io/solution-mq-rdqm-hadr/img/logo.svg"><meta data-rh="true" name="twitter:image" content="https://ibm-client-engineering.github.io/solution-mq-rdqm-hadr/img/logo.svg"><meta data-rh="true" property="og:url" content="https://ibm-client-engineering.github.io/solution-mq-rdqm-hadr/Co-Create/validate"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="ibm client engineering, open solutions library,  filenet, eks, aws, cp4ba, filenet on aws eks"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Validate | IBM Client Engineering"><meta data-rh="true" name="description" content="SSL configuration for MQ and MQ-IPT"><meta data-rh="true" property="og:description" content="SSL configuration for MQ and MQ-IPT"><link data-rh="true" rel="icon" href="/solution-mq-rdqm-hadr/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ibm-client-engineering.github.io/solution-mq-rdqm-hadr/Co-Create/validate"><link data-rh="true" rel="alternate" href="https://ibm-client-engineering.github.io/solution-mq-rdqm-hadr/Co-Create/validate" hreflang="en"><link data-rh="true" rel="alternate" href="https://ibm-client-engineering.github.io/solution-mq-rdqm-hadr/Co-Create/validate" hreflang="x-default"><link rel="stylesheet" href="/solution-mq-rdqm-hadr/assets/css/styles.1116ef7f.css">
<link rel="preload" href="/solution-mq-rdqm-hadr/assets/js/runtime~main.ae90d6c1.js" as="script">
<link rel="preload" href="/solution-mq-rdqm-hadr/assets/js/main.2f67b9e3.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/solution-mq-rdqm-hadr/"><div class="navbar__logo"><img src="/solution-mq-rdqm-hadr/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA" height="200" width="200"><img src="/solution-mq-rdqm-hadr/img/logo-dark.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU" height="200" width="200"></div><b class="navbar__title text--truncate">| Middleware Automation</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/${vars.org}/${vars.project}" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/solution-mq-rdqm-hadr/">Flight Path</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/solution-mq-rdqm-hadr/category/innovate">Innovate</a><button aria-label="Toggle the collapsible sidebar category &#x27;Innovate&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/solution-mq-rdqm-hadr/category/prepare">Prepare</a><button aria-label="Toggle the collapsible sidebar category &#x27;Prepare&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/solution-mq-rdqm-hadr/category/co-create">Co-Create</a><button aria-label="Toggle the collapsible sidebar category &#x27;Co-Create&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/solution-mq-rdqm-hadr/Co-Create/deploy">Deploy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/solution-mq-rdqm-hadr/Co-Create/validate">Validate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/solution-mq-rdqm-hadr/Co-Create/automate">Automate</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/solution-mq-rdqm-hadr/category/transition">Transition</a><button aria-label="Toggle the collapsible sidebar category &#x27;Transition&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/solution-mq-rdqm-hadr/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/solution-mq-rdqm-hadr/category/co-create"><span itemprop="name">Co-Create</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Validate</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Validate</h1></header><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ssl-configuration-for-mq-and-mq-ipt">SSL configuration for MQ and MQ-IPT<a href="#ssl-configuration-for-mq-and-mq-ipt" class="hash-link" aria-label="Direct link to SSL configuration for MQ and MQ-IPT" title="Direct link to SSL configuration for MQ and MQ-IPT">​</a></h3><p>For testing purposes, we are going to createa new queue manager and configure it with LDAP authentication and SSL.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-openldap-in-a-container">Configuring OpenLDAP in a container<a href="#configuring-openldap-in-a-container" class="hash-link" aria-label="Direct link to Configuring OpenLDAP in a container" title="Direct link to Configuring OpenLDAP in a container">​</a></h4><p><em>If you already have an Active Directory server or an LDAP host, you can skip this next part.</em></p><p>Now let&#x27;s get ldap going. For that, we&#x27;re gonna spin up an ldap container on a docker host that&#x27;s on the same networks as your clusters. Since this is a regional failover HADR cluster, you should probably have a second LDAP host running in this DR region and have replication for LDAP set up, but we won&#x27;t go into that here.</p><p>Let&#x27;s create some persistent file storage directories for the container to use first on our docker host:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p /LDAP_DIR/ldap /LDAP_DIR/slapd.d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod -R 777 /LDAP_DIR</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We are going to seed an ldif into this container. Create a file under <code>/LDAP_DIR</code> called <code>bootstrap.ldif</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dn: ou=people,dc=ibm,dc=com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: organizationalUnit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">description: All people in organization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ou: people</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dn: ou=groups,dc=ibm,dc=com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: organizationalUnit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: top</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ou: groups</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#MQ user + group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dn: uid=app,ou=people,dc=ibm,dc=com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: inetOrgPerson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: organizationalPerson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: person</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: top</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cn: appCN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sn: appSN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uid: app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userPassword: app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dn: cn=apps,ou=groups,dc=ibm,dc=com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: groupOfUniqueNames</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: top</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cn: apps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uniquemember: uid=app,ou=people,dc=ibm,dc=com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dn: uid=mqadmin,ou=people,dc=ibm,dc=com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: inetOrgPerson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: organizationalPerson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: person</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: top</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cn: mqadminCN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sn: mqadminSN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uid: mqadmin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userPassword: mqadmin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dn: cn=mqadmins,ou=groups,dc=ibm,dc=com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: groupOfUniqueNames</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: top</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cn: mqadmins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uniquemember: uid=mqadmin,ou=people,dc=ibm,dc=com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And now spin up a container making sure to mount that file as a custom seed. For our test setup we are using the osixia/openldap container image.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--restart=always \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-p 1636:1636 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-p 389:389 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-p 636:636 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-v /LDAP_DIR/bootstrap.ldif:/container/service/slapd/assets/config/bootstrap/ldif/custom/50-bootstrap.ldif \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-v /LDAP_DIR/ldap:/var/lib/ldap \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-v /LDAP_DIR/slapd.d:/etc/ldap/slapd.d \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--env LDAP_ORGANIZATION=&quot;IBM&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--env LDAP_ADMIN_PASSWORD=&quot;p@ssw0rd&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--env LDAP_CONFIG_PASSWORD=&quot;p@ssw0rd&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--env LDAP_ENABLE_TLS=&quot;yes&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--env LDAP_DOMAIN=&quot;ibm.com&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--hostname mq.openldap \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--name mq-openldap-container \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--detach osixia/openldap:latest \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--copy-service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For our purposes, we set the domain to <code>ibm.com</code> and then set an admin password of <code>p@ssw0rd</code>.</p><p>Now we&#x27;re going to configure our new queue mgr to auth with ldap. First we need to create the AUTHINFO object that will contain our ldap server info. This must be run by a member of the mqm group.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[mqm@wdc1-mq1 ~]$ runmqsc SSLDRHAQM1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5724-H72 (C) Copyright IBM Corp. 1994, 2022.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting MQSC for queue manager SSLDRHAQM1.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEFINE AUTHINFO(SSLDRHAQM1.IDPW.LDAP) AUTHTYPE(IDPWLDAP) ADOPTCTX(YES) CONNAME(&#x27;10.241.2.5(389)&#x27;) SECCOMM(NO) CHCKLOCL(OPTIONAL) CHCKCLNT(OPTIONAL) CLASSGRP(&#x27;groupOfUniqueNames&#x27;) CLASSUSR(&#x27;inetOrgPerson&#x27;) FINDGRP(&#x27;uniqueMember&#x27;) BASEDNG(&#x27;ou=groups,dc=ibm,dc=com&#x27;) BASEDNU(&#x27;ou=people,dc=ibm,dc=com&#x27;) LDAPUSER(&#x27;cn=admin,dc=ibm,dc=com&#x27;) LDAPPWD(&#x27;p@ssw0rd&#x27;) SHORTUSR(&#x27;uid&#x27;) GRPFIELD(&#x27;cn&#x27;) USRFIELD(&#x27;uid&#x27;) AUTHORMD(SEARCHGRP) NESTGRP(YES)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Above we&#x27;ve created an authinfo object. While everything above is needed, here are the most important settings:</p><ul><li>AUTHINFO - we&#x27;ve named it <code>SSLDRHAQM1.IDPQ.LDAP</code></li><li>AUTHTYPE - <code>IDPWLDAP</code> Connection authentication user ID and password checking is done using an LDAP server.</li><li>ADOPTCTX - <code>YES</code> - This means authenticated users are used for authorization checks, shown on administrative displays, and appear in messages.</li><li>CONNAME - <code>10.241.2.5(389)</code> This the actual ip address of our docker host where our ldap container is running</li><li>CHCKLOCL - This attribute determines the authentication requirements for locally bound applications, and is valid only for an AUTHTYPE of <code>IDPWOS</code> or <code>IDPWLDAP</code>. We are setting this to <code>OPTIONAL</code> which means locally bound applications are not required to provide a user ID and password. This is ideal for testing purposes.</li><li>CHCKCLNT - This attribute determines the authentication requirements for client applications, and is valid only for an AUTHTYPE of IDPWOS or IDPWLDAP. We&#x27;re setting it to <code>OPTIONAL</code> which means that client applications are not required to provide a user ID and password, but any provided will be authenticated against your authentication method. In our case, that&#x27;s LDAP.</li><li>SECCOMM - We aren&#x27;t using LDAPS in this example, so this is set to <code>NO</code></li></ul><p>The rest of the settings are LDAP specific and should be mostly self-explanatory.</p><p>Next, execute the following command to reconfigure the <strong>LDAPQM</strong> queue manager to use the new <strong>SSLDRHAQM1.IDPW.LDAP AUTHINFO object:</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ALTER QMGR CONNAUTH(SSLDRHAQM1.IDPW.LDAP)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REFRESH QMGR TYPE(CONFIGEV) OBJECT(AUTHREC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REFRESH SECURITY</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now restart the queuemgr</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[mqm@dwdc1-mq1 ~]$ endmqm -i SSLDRHAQM1 &amp;&amp; strmqm SSLDRHAQM1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now we need to set the authorizations and hope it all works. Make sure to run this command on the primary node as the <code>mqm</code> user:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">setmqaut -m SSLDRHAQM1 -t qmgr -g &quot;mqadmins&quot; +connect +inq +alladm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setmqaut -m SSLDRHAQM1 -n &quot;**&quot; -t q -g &quot;mqadmins&quot; +alladm +crt +browse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setmqaut -m SSLDRHAQM1 -n &quot;**&quot; -t topic -g &quot;mqadmins&quot; +alladm +crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setmqaut -m SSLDRHAQM1 -n &quot;**&quot; -t channel -g &quot;mqadmins&quot; +alladm +crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setmqaut -m SSLDRHAQM1 -n &quot;**&quot; -t process -g &quot;mqadmins&quot; +alladm +crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setmqaut -m SSLDRHAQM1 -n &quot;**&quot; -t namelist -g &quot;mqadmins&quot; +alladm +crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setmqaut -m SSLDRHAQM1 -n &quot;**&quot; -t authinfo -g &quot;mqadmins&quot; +alladm +crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setmqaut -m SSLDRHAQM1 -n &quot;**&quot; -t clntconn -g &quot;mqadmins&quot; +alladm +crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setmqaut -m SSLDRHAQM1 -n &quot;**&quot; -t listener -g &quot;mqadmins&quot; +alladm +crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setmqaut -m SSLDRHAQM1 -n &quot;**&quot; -t service -g &quot;mqadmins&quot; +alladm +crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setmqaut -m SSLDRHAQM1 -n &quot;**&quot; -t comminfo -g &quot;mqadmins&quot; +alladm +crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setmqaut -m SSLDRHAQM1 -n SYSTEM.MQEXPLORER.REPLY.MODEL -t q -g &quot;mqadmins&quot; +dsp +inq +get</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setmqaut -m SSLDRHAQM1 -n SYSTEM.ADMIN.COMMAND.QUEUE -t q -g &quot;mqadmins&quot; +dsp +inq +put</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can verify that LDAP auth is now working by running the following command using <code>mqadmin</code> as the user:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[mqm@wdc1-mq1 ~]$ runmqsc -u mqadmin SSLDRHAQM1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5724-H72 (C) Copyright IBM Corp. 1994, 2021.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter password:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*******</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting MQSC for queue manager SSLDRHAQM1.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The password for mqadmin is <code>mqadmin</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="testing">Testing<a href="#testing" class="hash-link" aria-label="Direct link to Testing" title="Direct link to Testing">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="summary-of-results">Summary of Results:<a href="#summary-of-results" class="hash-link" aria-label="Direct link to Summary of Results:" title="Direct link to Summary of Results:">​</a></h3><ul><li>Mean time to failover between regions: <code>2.8 seconds</code></li><li>Mean time to failover between zones: <code>547 millisecond</code></li><li>Data-Loss during local(zonal) failover: <code>0</code></li><li>Data-loss during regional failover: <code>0</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="testing-tools">Testing Tools<a href="#testing-tools" class="hash-link" aria-label="Direct link to Testing Tools" title="Direct link to Testing Tools">​</a></h3><ul><li>[MQ Toolkit for Mac][https://developer.ibm.com/tutorials/mq-macos-dev/]<!-- --> comes with sample client programs to test.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="failover-testing-for-mq-hadr-and-rdqm">Failover testing for MQ HADR and RDQM<a href="#failover-testing-for-mq-hadr-and-rdqm" class="hash-link" aria-label="Direct link to Failover testing for MQ HADR and RDQM" title="Direct link to Failover testing for MQ HADR and RDQM">​</a></h2><p>We have two avenues for testing failover:</p><ol><li>Local failover between nodes in each cluster<ol><li>Loadbalancer lives in each region and handles the traffic failover between nodes</li></ol></li><li>Regional failover between regions for disaster recovery<ol><li>MQIPT currently runs on our bastion host and provides proxied connections between regions. This does not support failover per se but does support converged proxying between sites.</li></ol></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="setup">Setup<a href="#setup" class="hash-link" aria-label="Direct link to Setup" title="Direct link to Setup">​</a></h3><p>It&#x27;s important to note that with a three node HA cluster, two nodes must be available to allow for a quorum. This is by design as in order to preserve the quorum between nodes, at least two nodes must be available.</p><p>Our two regions are defined thusly:</p><ul><li>DC<ul><li>DRHAQM1 - queue manager with primary cluster in DC</li><li>DRHAQM2 - standby queue manager for DRHAQM2</li></ul></li><li>Dallas<ul><li>DRHAQM2 - queue manager with primary cluster in Dallas</li><li>DRHAQM1 - standby queue manager for DRHAQM1</li></ul></li></ul><p>Each cluster is made up of three nodes:</p><p>DC</p><ul><li>wdc1-mq1</li><li>wdc2-mq1</li><li>wdc3-mq1</li></ul><p>Dallas</p><ul><li>dal1-mq1</li><li>dal2-mq1</li><li>dal3-mq1</li></ul><p>We create the following queues on each cluster. For the purposes of this test, we aren&#x27;t going to enable any security.</p><p>On wdc1-mq1</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">runmqsc DRHAQM1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ALTER QMGR CHLAUTH(DISABLED)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ALTER QMGR CONNAUTH(&#x27; &#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REFRESH SECURITY (*)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEFINE CHANNEL(DRHAMQ1.MQIPT) CHLTYPE(SVRCONN)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEFINE QLOCAL(MQIPT.LOCAL.QUEUE)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEFINE listener(LISTENER) trptype(tcp) control(qmgr) port(1501)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start listener(LISTENER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">QUIT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>On dal1-mq1</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">runmqsc DRHAQM1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ALTER QMGR CHLAUTH(DISABLED)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ALTER QMGR CONNAUTH(&#x27; &#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REFRESH SECURITY (*)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEFINE CHANNEL(DRHAMQ2.MQIPT) CHLTYPE(SVRCONN)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEFINE QLOCAL(MQIPT.LOCAL.QUEUE)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEFINE listener(LISTENER) trptype(tcp) control(qmgr) port(1502)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start listener(LISTENER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">QUIT</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We configure our settings on our MQIPT host</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[route]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name=DRHAQM1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Active=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ListenerPort=1501</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Destination=3bdf30c3-us-east.lb.appdomain.cloud</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DestinationPort=1501</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[route]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name=DRHAQM2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Active=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ListenerPort=1502</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Destination=e8deec77-us-south.lb.appdomain.cloud</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DestinationPort=1502</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The destination addresses are the load balancer for each region. This will move the connections between each node during failover.</p><p>We create a user that is part of the <code>mqm</code> group on each node. This is the user we must connect as when we run the tests.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="testing-with-persistent-messages-with-syncpoint">Testing with persistent messages with syncpoint<a href="#testing-with-persistent-messages-with-syncpoint" class="hash-link" aria-label="Direct link to Testing with persistent messages with syncpoint" title="Direct link to Testing with persistent messages with syncpoint">​</a></h3><p>Relevant github link:
<a href="https://github.com/ibm-messaging/mq-rdqm" target="_blank" rel="noopener noreferrer">https://github.com/ibm-messaging/mq-rdqm</a></p><p>For these utilities to work you must install <code>MQSeriesSDK-9.2.5-0.x86_64.rpm</code> which is part of the MQ client/server installation package <code>mqadv_dev925_linux_x86-64.tar.gz</code></p><p><strong>LINUX</strong>
Clone the above repo to your home directory</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/ibm-messaging/mq-rdqm.git</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Install the relevant build tools</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dnf -y install make cmake gcc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Go to the samples directory:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd mq-rdqm/samples/C/linux</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Update the <code>Makefile</code> to point to the <code>/opt/mqm</code> directory since that&#x27;s where all of MQ&#x27;s libs are installed.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MQDIR=/opt/mqm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Build the <code>rdqmget</code> and <code>rdqmput</code> binaries</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[kramerro@wdc-mq-client linux]$ make all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc -m64 -I /opt/mqm/inc -c ../complete.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc -m64 -I /opt/mqm/inc -c ../connection.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc -m64 -I /opt/mqm/inc -c ../globals.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc -m64 -I /opt/mqm/inc -c ../log.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc -m64 -I /opt/mqm/inc -c ../options.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc -m64 -I /opt/mqm/inc -o rdqmget ../rdqmget.c complete.o connection.o globals.o log.o options.o -L /opt/mqm/lib64 -l mqic_r -Wl,-rpath=/opt/mqm/lib64 -Wl,-rpath=/usr/lib64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc -m64 -I /opt/mqm/inc -o rdqmput ../rdqmput.c complete.o connection.o globals.o log.o options.o -L /opt/mqm/lib64 -l mqic_r -Wl,-rpath=/opt/mqm/lib64 -Wl,-rpath=/usr/lib64</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Export the MQSERVER env var and kick off the <code>rdqmget</code> command. The <code>&lt;mqipt adress&gt;</code> is our MQIPT server.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export MQSERVER=&quot;DRHAMQ1.MQIPT/TCP/&lt;mqipt address&gt;(1501)&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The syntax is the same as the default sample application</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;sample&gt; [options] &lt;queue manager name&gt; &lt;queue name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./rdqmput -b10 -m5 -v 1 DRHAQM1 MQIPT.LOCAL.QUEUE</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The default number of batches is 20 and the default batch size is 10 so by default rdqmput will put a total of 200 messages and rdqmget will get a total of 200 messages.</p><p>The above options will create 10 batches of 5 messages each. So we should see 50 messages when rdqmget drains the queue.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Connected to queue manager DRHAQM1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Opened queue MQIPT.LOCAL.QUEUE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 1 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 1 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 2 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 2 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 3 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 3 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 4 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 4 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 5 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 5 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 6 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 6 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 7 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 7 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 8 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 8 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 9 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 9 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 10 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 10 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Completed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now we retrieve them</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[kramerro@wdc-mq-client linux]$ ./rdqmget -b10 -m5 -v1 DRHAQM1 MQIPT.LOCAL.QUEUE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connected to queue manager DRHAQM1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Opened queue MQIPT.LOCAL.QUEUE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 1 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 1 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 2 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 2 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 3 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 3 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 4 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 4 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 5 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 5 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 6 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 6 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 7 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 7 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 8 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 8 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 9 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 9 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 10 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 10 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Completed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And the queue should be empty.</p><p>Next lets try a failover in the WDC cluster. FIrst we&#x27;ll load up the queue with 10 batches of 5 messages each.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[kramerro@wdc-mq-client linux]$ ./rdqmput -b10 -m5 -v1 DRHAQM1 MQIPT.LOCAL.QUEUE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connected to queue manager DRHAQM1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Opened queue MQIPT.LOCAL.QUEUE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 1 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 1 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 2 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 2 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 3 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 3 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 4 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 4 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 5 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 5 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 6 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 6 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 7 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 7 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 8 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 8 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 9 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 9 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 10 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 10 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Completed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now lets failover the cluster to node2.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@wdc1-mq1 ~]# rdqmadm -s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The replicated data node &#x27;wdc1-mq1&#x27; has been suspended.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This puts the primary node into standby node and shifts the queue over to node2. This can be verified with the following command on node2.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@wdc2-mq1 ~]# /opt/mqm/bin/dspmq -a -x -s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">QMNAME(DRHAQM1)                                           STATUS(Running)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    INSTANCE(wdc2-mq1) MODE(Active)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The load balancer should have shifted over the connection as well. So now from our client going through MQIPT, let&#x27;s see if we can retrieve the messages we put in.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[kramerro@wdc-mq-client linux]$ ./rdqmget -b10 -m5 -v1 DRHAQM1 MQIPT.LOCAL.QUEUE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connected to queue manager DRHAQM1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Opened queue MQIPT.LOCAL.QUEUE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 1 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 1 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 2 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 2 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 3 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 3 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 4 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 4 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 5 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 5 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 6 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 6 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 7 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 7 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 8 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 8 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 9 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 9 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 10 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 10 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Completed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And there they are. Let&#x27;s push some messages back into the queue and fail back to node1.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[kramerro@wdc-mq-client linux]$ ./rdqmput -b10 -m5 -v1 DRHAQM1 MQIPT.LOCAL.QUEUE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connected to queue manager DRHAQM1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Opened queue MQIPT.LOCAL.QUEUE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 1 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 1 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 2 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 2 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 3 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 3 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 4 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 4 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 5 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 5 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 6 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 6 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 7 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 7 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 8 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 8 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 9 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 9 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 10 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 10 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Completed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now fail things back over</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@wdc1-mq1 ~]# rdqmadm -r</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The replicated data node &#x27;wdc1-mq1&#x27; has been resumed.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We should see the queue back on node1 now.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@wdc1-mq1 ~]# /opt/mqm/bin/dspmq -a -x -s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">QMNAME(DRHAQM1)                                           STATUS(Running)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    INSTANCE(wdc1-mq1) MODE(Active)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now from our client, let&#x27;s get these messages.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[kramerro@wdc-mq-client linux]$ ./rdqmget -b10 -m5 -v1 DRHAQM1 MQIPT.LOCAL.QUEUE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connected to queue manager DRHAQM1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Opened queue MQIPT.LOCAL.QUEUE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 1 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 1 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 2 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 2 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 3 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 3 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 4 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 4 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 5 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 5 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 6 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 6 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 7 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 7 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 8 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 8 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 9 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 9 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 10 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 10 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Completed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And there they are.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="regional-failover-testing">Regional failover testing<a href="#regional-failover-testing" class="hash-link" aria-label="Direct link to Regional failover testing" title="Direct link to Regional failover testing">​</a></h3><p>First. let&#x27;s write some messages to the queue. We&#x27;ll export the MQSERVER env var still pointing to the MQIPT host and then write those messages.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[kramerro@wdc-mq-client linux]$ export MQSERVER=&quot;DRHAMQ1.MQIPT/TCP/&lt;mqipt address&gt;(1501)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[kramerro@wdc-mq-client linux]$ ./rdqmput -b10 -m5 -v1 DRHAQM1 MQIPT.LOCAL.QUEUE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connected to queue manager DRHAQM1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Opened queue MQIPT.LOCAL.QUEUE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 1 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 1 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 2 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 2 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 3 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 3 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 4 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 4 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 5 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 5 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 6 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 6 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 7 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 7 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 8 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 8 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 9 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 9 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 10 put successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 10 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Completed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>IMPORTANT</strong>: <em>When failing between regions, this is not an automated process. If Region 1 went down completely, Region 2 would need to be manually started as it is for Disaster Recovery and not High Availibility. These processes can be automated externally with a monitoring solution that detects the loss of Region 1 and triggers an automated process that starts up Region 2. An example of how one might achieve this using Ansible has been provided in the <strong>resources</strong> folder in this repo.</em> </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="failing-over-to-dallas">Failing over to Dallas<a href="#failing-over-to-dallas" class="hash-link" aria-label="Direct link to Failing over to Dallas" title="Direct link to Failing over to Dallas">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@wdc1-mq1 ~]# rdqmdr -s -m DRHAQM1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Queue manager &#x27;DRHAQM1&#x27; has been made the DR secondary on this node.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And in Dallas, we have to tell node 1 that it&#x27;s now primary for that queue manager</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@ceng-dal1-mq1 ~]# rdqmdr -p -m DRHAQM1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Queue manager &#x27;DRHAQM1&#x27; has been made the DR primary on this node.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now we should see on node 1 in Dallas that we are now primary for that queue manager</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@ceng-dal1-mq1 ~]# /opt/mqm/bin/dspmq -a -x -s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">QMNAME(DRHAQM1)                                           STATUS(Running)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    INSTANCE(ceng-dal1-mq1) MODE(Active)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now let&#x27;s modify MQIPT to point to the Dallas cluster for this queue manager. Edit <code>/opt/mqipt/installation1/mqipt/HAMQ/mqipt.conf</code></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[route]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name=DRHAQM1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Active=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ListenerPort=1501</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Destination=3bdf30c3-us-east.lb.appdomain.cloud</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DestinationPort=1501</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[route]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name=DRHAQM2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Active=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ListenerPort=1502</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Destination=e8deec77-us-south.lb.appdomain.cloud</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DestinationPort=1502</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We are going to change the Destination for DRHAMQ1 to point to the load balancer in Dallas.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[route]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name=DRHAQM1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Active=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ListenerPort=1501</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Destination=e8deec77-us-south.lb.appdomain.cloud</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DestinationPort=1501</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[route]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name=DRHAQM2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Active=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ListenerPort=1502</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Destination=e8deec77-us-south.lb.appdomain.cloud</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DestinationPort=1502</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now refresh mqipt with the following command. We have named this MQIPT instance to HAMQ:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@wdc-bastion:/opt/mqipt/installation1/mqipt/HAMQ# /opt/mqipt/installation1/mqipt/bin/mqiptAdmin -refresh -n HAMQ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">June 2, 2022 7:26:11 PM UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MQCAI105 Sending REFRESH command to MQIPT instance with name HAMQ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MQCAI025 MQIPT HAMQ has been refreshed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now from our client, let&#x27;s see if the messages are there.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[kramerro@wdc-mq-client linux]$ ./rdqmget -b10 -m5 -v1 DRHAQM1 MQIPT.LOCAL.QUEUE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connected to queue manager DRHAQM1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Opened queue MQIPT.LOCAL.QUEUE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 1 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 1 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 2 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 2 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 3 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 3 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 4 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 4 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 5 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 5 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 6 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 6 committed successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 7 got successfully, committing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Batch 7 committed successfully</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ibm-client-engineering/solution-mq-rdqm-hadr.git/docs/3-Co-Create/2-Validate.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/solution-mq-rdqm-hadr/Co-Create/deploy"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Deploy</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/solution-mq-rdqm-hadr/Co-Create/automate"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Automate</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ssl-configuration-for-mq-and-mq-ipt" class="table-of-contents__link toc-highlight">SSL configuration for MQ and MQ-IPT</a><ul><li><a href="#configuring-openldap-in-a-container" class="table-of-contents__link toc-highlight">Configuring OpenLDAP in a container</a></li></ul></li><li><a href="#testing" class="table-of-contents__link toc-highlight">Testing</a><ul><li><a href="#summary-of-results" class="table-of-contents__link toc-highlight">Summary of Results:</a></li><li><a href="#testing-tools" class="table-of-contents__link toc-highlight">Testing Tools</a></li></ul></li><li><a href="#failover-testing-for-mq-hadr-and-rdqm" class="table-of-contents__link toc-highlight">Failover testing for MQ HADR and RDQM</a><ul><li><a href="#setup" class="table-of-contents__link toc-highlight">Setup</a></li><li><a href="#testing-with-persistent-messages-with-syncpoint" class="table-of-contents__link toc-highlight">Testing with persistent messages with syncpoint</a></li><li><a href="#regional-failover-testing" class="table-of-contents__link toc-highlight">Regional failover testing</a></li><li><a href="#failing-over-to-dallas" class="table-of-contents__link toc-highlight">Failing over to Dallas</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.ibm.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">IBM</a></li><li class="footer__item"><a href="https://www.ibm.com/client-engineering" target="_blank" rel="noopener noreferrer" class="footer__link-item">IBM Client Engineering</a></li></ul></div></div></div></footer></div>
<script src="/solution-mq-rdqm-hadr/assets/js/runtime~main.ae90d6c1.js"></script>
<script src="/solution-mq-rdqm-hadr/assets/js/main.2f67b9e3.js"></script>
</body>
</html>